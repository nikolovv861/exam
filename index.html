<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<title>Online Exam</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<style>
    body, html {
        font-family: Arial, sans-serif;
        padding: 0;
        margin: 0;
        background-color: #f4f4f9;
        width: 100%;
        height: 100%;
    }
    #exam-container {
        background: white;
        width: 600px; /* Responsive width can be controlled via Bootstrap classes if needed */
        padding: 40px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        margin: 50px auto;
        position: relative;
    }
    #question {
        font-size: 20px;
        margin-bottom: 10px;
    }
    #choices {
        margin: 20px 0;
    }
    #choices li {
        padding: 8px;
        background-color: #f0f0f0;
        margin-bottom: 5px;
        cursor: pointer;
        list-style: none;
        position: relative;
    }
    #choices li::before {
        content: '';
        display: block;
        width: 10px;
        height: 10px;
        background-color: #0056b3;
        border-radius: 50%;
        position: absolute;
        left: -20px;
        top: 50%;
        transform: translateY(-50%);
        opacity: 0;  /* Initially hidden */
        transition: opacity 0.3s;
    }
    #choices li.selected::before {
        opacity: 1;  /* Visible when selected */
    }
    #choices li.selected {
        background-color: #adc6ff;
    }
    #full-page-message {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        color: white;
        display: none;
        justify-content: center;
        align-items: center;
        font-size: 30px;
        text-align: center;
        z-index: 1000;
    } 
    #timer {
        position: absolute;
        top: 20px;
        right: 20px;
        font-size: 16px;
        background-color: rgba(255, 255, 255, 0.8);
        padding: 5px 10px;
        border-radius: 5px;
        display: inline-block;
    }
    #timer::before {
        content: 'ðŸ•’';
        margin-right: 5px;
    }
</style>
</head>
<body>
<div id="exam-container" class="container">
    <div id="question-number" class="h5"></div>
    <div id="question" class="h4 mb-3"></div>
    <ul id="choices" class="list-group"></ul>
    <div class="mt-3 text-center">
        <button class="btn btn-primary me-2" onclick="previous_question()">Previous</button>
        <button class="btn btn-primary ms-2" onclick="next_question()">Next</button>
        <button class="btn btn-success ms-2" onclick="submit_exam()">Submit Exam</button>
    </div>
    <div id="timer" class="badge bg-secondary"></div>
</div>
<div id="full-page-message"></div>

<script>

// Global
//////////////////////////////////////////////////
var current_question_index = 0;
var score = 0;
var total_seconds = 0;
var seconds_in_focus = 0;
var seconds_in_cheating = 0;
var allowed_seconds_for_cheating = 60;
//var allowed_seconds_for_cheating = 0;
var timer;
var answered = [];


//////////////////////////////////////////////////
const questions = [
    {
        "question": "What does HTML stand for?", 
        "choices": [
            "Hyperlinks and Text Markup Language",
            "Hyper Text Markup Language",
            "Home Tool Markup Language"
        ],
        "correct_answer": 1,
    },
    {"question": "Who is making the Web standards?", "choices": ["Mozilla", "Google", "The World Wide Web Consortium", "Microsoft"], "correct_answer": 2},
    {"question": "Choose the correct HTML element for the largest heading:", "choices": ["<h1>", "<head>", "<heading>", "<h6>"], "correct_answer": "a"},
    {"question": "What is the correct HTML element for inserting a line break?", "choices": ["<br>", "<break>", "<lb>"], "correct_answer": "a"},
    {"question": "What is the correct HTML for adding a background color?", "choices": ["<background>yellow</background>", "<body bg=\u201dyellow\u201d>", "<body style=\u201dbackground-color:yellow\u201d>"], "correct_answer": "c"},
    {"question": "Choose the correct HTML element to define important text:", "choices": ["<b>", "<i>", "<important>", "<strong>"], "correct_answer": "d"},
    {"question": "Choose the correct HTML element to define emphasized text:", "choices": ["<em>", "<i>", "<italic>"], "correct_answer": "a"},
    {"question": "What is the correct HTML for creating a hyperlink?", "choices": ["<a> https://www.w3schools.com</a>", "<a name= https://www.w3schools.com>W3Schools.com</a>", "<a href=\u201d https://www.w3schools.com\u201d>W3schools</a>", "<a url=\u201d https://www.w3schools.com\u201d>W3schools.com</a>"], "correct_answer": "c"},
    {"question": "Which character is used to indicate an end tag?", "choices": ["*", "<", "^", "/"], "correct_answer": "d"},
    {"question": "How can you open a link in a new tab/browser window?", "choices": ["<a href=\u201durl\u201dnew>", "<a href=\u201durl\u201dtarget=\u201d_blank\u201d>", "<a href=\u201durl\u201dtarget=\u201dnew\u201d>"], "correct_answer": "b"},
    {"question": "Which of these elements are all <table> elements?", "choices": ["<table> <tr> <tt>", "<thead> <body> <tr>", "<table> <head> <tfoot>", "<table> <tr> <td>"], "correct_answer": "d"},
    {"question": "Inline elements are normally displayed without starting a new line.", "choices": ["False", "True"], "correct_answer": "b"},
    {"question": "How can you make a numbered list?", "choices": ["<ul>", "<dl>", "<ol>", "<list>"], "correct_answer": "c"},
    {"question": "How can you make a bulleted list?", "choices": ["<ul>", "<list>", "<ol>", "<dl>"], "correct_answer": "a"},
    {"question": "What is the correct HTML for making a checkbox?", "choices": ["<input type =\u201dcheckbox\u201d>", "Input type=\u201dcheck\u201d>", "<check>", "<chechbox>"], "correct_answer": "a"},
    {"question": "What is the correct HTML for making a text input field?", "choices": ["<input type=\u201dtext\u201d>", "<textinput type=\u201dtext\u201d>", "<input type=\u201dtextfield\u201d>", "<textfield>"], "correct_answer": "a"},
    {"question": "What is the correct HTML for making a drop-down list?", "choices": ["<input type=\u201dlist\u201d>", "<input type=\u201ddropdown\u201d>", "<select>", "<list>"], "correct_answer": "c"},
    {"question": "What is the correct HTML for making a text area?", "choices": ["<input type=\u201dtextbox\u201d>", "<input type=\u201dtextarea\u201d>", "<textarea>"], "correct_answer": "c"},
    {"question": "What is the correct HTML for inserting an image?", "choices": ["<img src=\u201dimage.gif\u201d alt=\u201dMyImage\u201d>", "<img href=\u201dimage.gif\u201d alt=\u201dMyImage\u201d>", "<image src=\u201dimage.gif\u201d alt=\u201dMyImage\u201d>", "<img alt= \u201dMyImage\u201d>image.gif</img>"], "correct_answer": "a"},
    {"question": "What is the correct HTML for inserting a background image?", "choices": ["<body style=background-image:url(background.gif)\u201d>", "<background img=\u201dbackground.gif\u201d>", "<body bg=\u201dbackground.gif\u201d>"], "correct_answer": "a"},
    {"question": "An <iframe> is used to display a web page within a web page.", "choices": ["False", "True", "There is no such thing as an <iframe>"], "correct_answer": "b"},
    {"question": "HTML comments start with <!-- and end with -->", "choices": ["False", "True"], "correct_answer": "b"},
    {"question": "Block elements are normally displayed without starting a new line.", "choices": ["True", "False"], "correct_answer": "b"},
    {"question": "Which HTML element defines the title of a document?", "choices": ["<title>", "<meta>", "<head>"], "correct_answer": "a"},
    {"question": "Which HTML attribute specifies an alternate text for an image if the image cannot be displayed?", "choices": ["Longdesc", "alt", "title", "src"], "correct_answer": "b"},
    {"question": "Which doctype is correct for HTML5?", "choices": ["<!DOCTYPE html>", "<!DOCTYPE HTML5>", "<!DOCTYPE HTML PUBLIC\u201d-//W3C//DTD HTML 5.0//EN\u201d http://www.w3.org/TR/html5/strict.dtd>"], "correct_answer": "a"},
    {"question": "Which HTML element is used to specify a footer for a document or section?", "choices": ["<footer>", "<bottom>", "<section>"], "correct_answer": "a"},
    {"question": "In HTML you can embed SVG elements directly into an HTML page.", "choices": ["True", "False"], "correct_answer": "a"},
    {"question": "What is the correct HTML element for playing video files?", "choices": ["<movie>", "<media>", "<video>"], "correct_answer": "c"},
    {"question": "What is the correct HTML element for playing audio files?", "choices": ["<sound>", "<mp3>", "<audio>"], "correct_answer": "c"},
    {"question": "The HTML global attribute \"contenteditable\" is used to:", "choices": ["Update content from the server", "Return the position of the first found occurrence of content inside a string", "Specifies a context menu for an element. The menu appears when a user right-clicks on the element", "Specify whether the content of an element should be editable or not"], "correct_answer": "d"},
    {"question": "In HTML onblur and onfocus are:", "choices": ["HTML elements", "Style attributes", "Event attributes"], "correct_answer": "c"},
    {"question": "Graphics defined by SVG is in which format?", "choices": ["HTML", "CSS", "XML"], "correct_answer": "c"},
    {"question": "The HTML <canvas> element is used to:", "choices": ["Manipulate data in MySQL", "Create draggable elements", "Display database records", "Draw graphics"], "correct_answer": "d"},
    {"question": "In HTML which attribute is used to specify that an input field must be filled out?", "choices": ["Formvalidate", "Placeholder", "Required", "Validate"], "correct_answer": "c"},
    {"question": "Which input type defines a slider control?", "choices": ["Slider", "Controls", "Range", "Search"], "correct_answer": "c"},
    {"question": "Which HTML element is used to display a scalar measurement within a range?", "choices": ["<range>", "<gauge>", "<meter>", "<measure>"], "correct_answer": "c"},
    {"question": "Which HTML element defines navigation links?", "choices": ["<navigate>", "<nav>", "<navigation>"], "correct_answer": "b"},
    {"question": "In HTML what does the <aside> element define?", "choices": ["Content aside from the page content", "A navigation list to be shown at the left side of the page", "The ASCII character-set; to send information between computers on the internet"], "correct_answer": "a"},
    {"question": "Which HTML element is used to specify a header for a document or section?", "choices": ["<head>", "<header>", "<top>", "<section>"], "correct_answer": "b"}
];

//////////////////////////////////////////////////
window.onload = function() {
    start_timer();
    show_question(current_question_index);
    
    // cheating tester
    document.addEventListener('visibilitychange', function() {
        var now = new Date().toISOString().slice(0, 19);
        //console.log('visibilitychange', now);
        //console.log(document.visibilityState);
        
        //if (document.hidden) console.log('The page is not in focus.');
        //else console.log('The page is in focus.');
        
        if (allowed_seconds_for_cheating == 0 
            && document.visibilityState === 'hidden'
        ) {
            fail_exam_for_cheating();
        }
    });
};

//////////////////////////////////////////////////
function start_timer() {
    timer = setInterval(function() {

        if(document.hidden) seconds_in_cheating += 1;
        else seconds_in_focus += 1;
        
        if(seconds_in_cheating > allowed_seconds_for_cheating) {
            fail_exam_for_cheating();
        } 

        total_seconds++;
        document.getElementById('timer').innerText = 'Time: '+total_seconds+' seconds';
        
        console.log('total_seconds',total_seconds);
        console.log('seconds_in_focus',seconds_in_focus);
        console.log('seconds_in_cheating',seconds_in_cheating);
    }, 1000);
}

//////////////////////////////////////////////////
function show_question(index) {
    const question_object = questions[index];
    
    document.getElementById('question-number').innerText 
        = "Question " + (index + 1) + " of " + questions.length;
    document.getElementById('question').innerText 
        = question_object.question;
    
    var choises_element = document.getElementById('choices');
    choises_element.innerHTML = '';
    
    question_object.choices.forEach(function(choice, i) {
        var li = document.createElement('li');
        li.innerText = choice;
        li.onclick = function() { select_answer(i, index); };
        choises_element.appendChild(li);
    });
    
    if (answered[index] != null) {
        choises_element.children[answered[index]].classList.add('selected');
    }
}

//////////////////////////////////////////////////
function select_answer(selected_index, question_index) {
    var choices_children = document.getElementById('choices').children;
    var previously_selected_answer = answered[question_index];
    answered[question_index] = selected_index;

    var choices_children_length = choices_children.length;
    for (var i = 0; i < choices_children_length; i++) {
        choices_children[i].classList.remove('selected');
    }
    choices_children[selected_index].classList.add('selected');

    //if point was given remove it
    if (previously_selected_answer != null) {
        if (previously_selected_answer === questions[question_index].correct_answer) {
            score--; 
        }
    }
    if (selected_index === questions[question_index].correct_answer) {
        score++;
    }
}

//////////////////////////////////////////////////
function next_question() {
    if (current_question_index < questions.length - 1) {
        current_question_index++;
        show_question(current_question_index);
    }
}

//////////////////////////////////////////////////
function previous_question() {
    if (current_question_index > 0) {
        current_question_index--;
        show_question(current_question_index);
    }
}

//////////////////////////////////////////////////
function fail_exam_for_cheating() {
    end_exam(true);
}

//////////////////////////////////////////////////
function submit_exam() {
    end_exam(false);
}

//////////////////////////////////////////////////
function end_exam(cheated) {
    clearInterval(timer);
    let message = cheated ? "You have tried to cheat, please try again" : `Exam finished! Your score: ${score}, Time taken: ${total_seconds} seconds`;
    document.getElementById('full-page-message').style.display = 'flex';
    document.getElementById('full-page-message').innerText = message;

    console.log('total_seconds',total_seconds);
    console.log('seconds_in_focus',seconds_in_focus);
    console.log('seconds_in_cheating',seconds_in_cheating);
}
</script>
</body>
</html>
